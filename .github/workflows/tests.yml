name: ðŸŽ­ Tests
on:
  push:
    paths-ignore:
      - .chglog/**
      - .github/**
      - '!.github/workflows/tests.yml'
      - .editorconfig
      - .gitattributes
      - .gitignore
      - .htaccess
      - '**.md'
    branches:
      - master
  pull_request:
    paths-ignore:
      - .chglog/**
      - .github/**
      - '!.github/workflows/tests.yml'
      - .editorconfig
      - .gitattributes
      - .gitignore
      - .htaccess
      - '**.md'
    branches:
      - master

jobs:
  phpstan:
    strategy:
      matrix:
        php_version: [ '7.4', '8.0' ]
    container: syntrocontainer/silverstripe-dev:${{ matrix.php_version }}-apache-buster
    name: ðŸ”º PHPStan
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v3
      - name: Prep Module
        uses: syntro-opensource/workflows/actions/silverstripe-module-prep@master
        with:
          silverstripe_version: '4.10'
      - name: Run PHPStan
        uses: syntro-opensource/workflows/actions/silverstripe-module-phpstan@master
        with:
          dir: src/
  phpcs:
    name: ðŸ”® PHPcs - src
    uses: syntro-opensource/workflows/.github/workflows/silverstripe-phpcs.yml@master
    with:
      dir: src/